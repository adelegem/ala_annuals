concave_nested <- fire_ephemerals_nested %>%
mutate(points_sf = map(.x = data,
~ st_as_sf(.x, coords = c("decimalLongitude", "decimalLatitude"),
crs = 4326)),
concave_sf = map(points_sf,
~ concaveman(.x)))
concave_nested
# Compute range overlap and descriptive statistics and select
overlap_nested <- concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x) |> select(-Id))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100))) |>
unnest(cols = c(overlap_area, percent_overlap))
concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x) |> select(-Id))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100)))
concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x) |> select(-Id))))
concave_nested |> pluck(concave_sf)
concave_nested |> pluck("concave_sf")
concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x))))
# Compute range overlap and descriptive statistics and select
overlap_nested <- concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100))) |>
unnest(cols = c(overlap_area, percent_overlap))
concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100)))
overlap_nested <- concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100)))
?unnest
overlap_nested |>
unnest(c(overlap_area, percent_overlap))
overlap_nested %>%
unnest(cols = c(overlap_area, percent_overlap))
overlap_nested
overlap_nested |>
unnest(cols = c("overlap_area", "percent_overlap"))
unnest(overlap_nested, cols = c(overlap_area, percent_overlap))
tidyr::unnest(overlap_nested, cols = c(overlap_area, percent_overlap))
# Compute range overlap and descriptive statistics and select
overlap_nested <- concave_nested |>
mutate(overlap_sf = map(concave_sf,
possibly(~ st_intersection(fire_union, .x))),
overlap_area = map(overlap_sf,
possibly(~ st_area(.x))),
percent_overlap = map2(.x = overlap_area,
.y = concave_sf,
possibly(~ (.x / st_area(.y))*100))) |>
tidyr::unnest(cols = c(overlap_area, percent_overlap))
map_data <- overlap_nested |>
select(genus, overlap_area, percent_overlap, points_sf, concave_sf, overlap_sf) |>
unnest() |>
rename(points = geometry,
concave = polygons,
overlap = geometry1)
map_data <- overlap_nested |>
select(genus, overlap_area, percent_overlap, points_sf, concave_sf, overlap_sf) |>
tidyr::unnest() |>
rename(points = geometry,
concave = polygons,
overlap = geometry1)
overlap_nested |>
select(genus, overlap_area, percent_overlap, points_sf, concave_sf, overlap_sf) |>
tidyr::unnest()
map_data <- overlap_nested |>
select(genus, overlap_area, percent_overlap, points_sf, concave_sf, overlap_sf) |>
tidyr::unnest() |>
rename(points = geometry,
concave = polygons,
overlap = overlap_sf)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#ED8147',
alpha = 0.4) +
geom_sf(data = map_data,
aes(geometry = overlap
),
colour = "#FF925C", fill = "#FF925C") +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#ED8147',
alpha = 0.4) +
geom_sf(data = map_data,
aes(geometry = overlap),
colour = "#FF925C", fill = "#FF925C") +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
# text = element_text(family = "Arial"),
legend.position = "right",
# plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.3) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
# geom_sf(data = overlap,
#       aes(geometry = overlap_sf,
#           colour = NA,
#           ),
#       colour = "#FF925C", fill = "#FF925C",
#       alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
my_colours <- c("#1D2B12", pilot::pilot_color("#607109"), "#1B9E65"
# , "#8DA17D", "#1C2912"
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FFD65C", fill = "#FFD65C",
alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
my_colours <- c("#1D2B12", "#607109", "#1B9E65"
# , "#8DA17D", "#1C2912"
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FFD65C", fill = "#FFD65C",
alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
my_colours <- c("#1D2B12", "#3B7009", "#9E701B"
# , "#8DA17D", "#1C2912"
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
# geom_point(data = fire_ephemerals,
#            aes(x = decimalLongitude,
#                y = decimalLatitude,
#                color = genus),
#            alpha= 0.7,
#            size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = ozmap_country,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
# geom_point(data = fire_ephemerals,
#            aes(x = decimalLongitude,
#                y = decimalLatitude,
#                color = genus),
#            alpha= 0.7,
#            size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = ozmap_states,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
# geom_point(data = fire_ephemerals,
#            aes(x = decimalLongitude,
#                y = decimalLatitude,
#                color = genus),
#            alpha= 0.7,
#            size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = ozmap_states,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
# geom_point(data = fire_ephemerals,
#            aes(x = decimalLongitude,
#                y = decimalLatitude,
#                color = genus),
#            alpha= 0.7,
#            size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
coord_sf(xlim = c(140, 158)) +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = ozmap_states,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
# geom_point(data = fire_ephemerals,
#            aes(x = decimalLongitude,
#                y = decimalLatitude,
#                color = genus),
#            alpha= 0.7,
#            size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
coord_sf(xlim = c(135, 158)) +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
# geom_sf(data = overlap,
#       aes(geometry = overlap_sf,
#           colour = NA,
#           ),
#       colour = "#FF925C", fill = "#FF925C",
#       alpha = 0.8) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
coord_sf(xlim = c(135, 158)) +
theme(plot.background = element_rect(fill = "white", color = NA),
text = element_text(family = "Arial"),
legend.position = "right",
plot.title = element_text(size = 15, hjust = 0.5)
)
concave_nested |> pluck("concave_sf")
ggplot() +
geom_sf(data = ozmap_states,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#FF925C',
alpha = 0.4) +
geom_sf(data = overlap,
aes(geometry = overlap_sf,
colour = NA,
),
colour = "#FF925C", fill = "#FF925C",
alpha = 0.8) +
scale_color_manual(values = my_colours) +
theme_map() +
coord_sf(xlim = c(135, 158)) +
theme(plot.background = element_rect(fill = "white", color = NA))
ggplot() +
geom_sf(data = nsw,
fill = 'white',
colour = "grey50") +
geom_sf(data = fire_union,
colour = NA,
fill = '#ED8147',
alpha = 0.4) +
geom_point(data = fire_ephemerals,
aes(x = decimalLongitude,
y = decimalLatitude,
color = genus),
alpha= 0.7,
size = 3) +
# labs(title = 'Fire history and fire ephemeral species in NSW', color = 'Species') +
scale_color_manual(values = my_colours) +
theme_map() +
theme(plot.background = element_rect(fill = "white", color = NA),
# text = element_text(family = "Arial"),
legend.position = "right",
# plot.title = element_text(size = 15, hjust = 0.5)
)
